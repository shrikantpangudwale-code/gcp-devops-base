# gcp-devops-base

This project is developed by DevOps Engineers to automate the deployment of a **Node.js application** on **Google App Engine** using modern CI/CD practices and tools on **Google Cloud Platform (GCP)**.

### üöÄ Tools & Technologies Used

1. **Google Cloud Platform**
   - App Engine  
   - Compute Engine  
   - Cloud Shell  
   - Cloud Storage  
2. **Jenkins** (for CI/CD pipelines)  
3. **Terraform** (for infrastructure provisioning)  
4. **Shell Scripts** (for automation tasks)  
5. **Python** (for CbN workflow execution scripts)  
6. **Groovy** (for Jenkins configuration)

---

### üìÅ Project Structure Overview

<p align="center">
  <img width="360" alt="Project Architecture" src="https://user-images.githubusercontent.com/106592300/178190993-d9e8056e-3c75-42b6-b347-4f1756b2985f.PNG">
</p>

### üìÇ Repository Structure

This repository contains the following subdirectories:

| #  | Directory        | Description |
|----|------------------|-------------|
| 1. | `terraform`      | Contains Terraform scripts to provision key GCP resources such as a Service Account, Virtual Network, Subnet, Firewall Rules, and a VM Instance. |
| 2. | `shell-scripts`  | Includes Bash scripts to install, configure, and restore Jenkins. It also installs Java Runtime, Terraform, Nginx, and Python utilities on the VM Instance. |
| 3. | `groovy-scripts` | Contains Groovy scripts used by Jenkins to create an admin user and install required plugins automatically. |

--------------------------------------------------------------------------------------------------------------------------------------------------------------

### Pre-Requisites

1. **Google Cloud Platform (GCP):**  
   - Create a GCP Project.  
   - Enable the following services:
     - Google App Engine  
     - Google Compute Engine  
     - Google Cloud Storage (used for Terraform state and Jenkins backups)  
   - Reserve a static IP address.

2. **Domain Configuration:**  
   - A domain is required for hosting Jenkins and the target application.  
   - **Note:** This setup uses [deSEC](https://desec.io) for DNS management.

3. **Required GitHub Repositories:**
   - [`application-cpp-code`](https://github.com/CBN-Project-Deployment/Gridctrl_src_CplusPlus.git)  
     Source code for the C++ MFC application, which serves as input to CbN.
     
   - [`gcp-devops-base`](https://github.com/shrikantpangudwale-code/gcp-devops-base.git)  
     Contains Terraform and shell scripts to automate the deployment of the application on GCP App Engine.
     
   - [`cbn-workflow-execution-code`](https://github.com/CBN-Project-Deployment/CBN_Workflow_PY.git)  
     Python scripts to trigger CbN API calls and execute workflows.
     
   - [`target-react-app`](https://github.com/CBN-Project-Deployment/React-Dep.git)  
     React.js application code generated by CbN workflows.
     
   - [`application-documents`](https://github.com/CBN-Project-Deployment/App-Documentations.git)  
     PDF documentation generated by CbN explaining the application structure and workflows.


### Process

1. **Clone the Repository**  
  - Open the [Google Cloud Shell](https://shell.cloud.google.com) and clone the `gcp-devops-base` repository:
   ```bash
    git clone https://github.com/shrikantpangudwale-code/gcp-devops-base.git
  ```  
2. **Navigate to the Project Directory**
  ```bash
    cd gcp-devops-base
  ```
3. **Create `.env` file with Sensitive Credentials**
  - `DESEC_Email=`
  - `DESEC_API_TOKEN=`
  - `github_user=`
  - `github_cred=` 
   - **Note**: The `.env` file is listed in `.gitignore` and is **not** part of the repository.
4. **Update environment specific values**
  - Edit the `configfile` and provide values according to your GCP and domain setup.
5. **Make the Deployment Script Executable**
  ```bash
    chmod +x devops-base.sh
  ```
6. **Run the deployment script**
  ```bash
    sh devops-base.sh
  ```
7. **Access Jenkins**
  - After successful deployment, Jenkins will be available at: `https://jenkins.nttd.dedyn.io`.
8. **Run Jenkins Pipelines**
  - The Jenkins dashboard will display pre-configured pipelines. Trigger them as needed to continue with CbN workflow execution and app deployment.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
### `configfile`

The `configfile` contains environment-specific variables that must be manually configured before running the deployment script for the first time.

| Variable              | Description                                                                 |
|-----------------------|-----------------------------------------------------------------------------|
| `gcp_project`         | Name of your Google Cloud Platform project                                  |
| `gcp_region`          | GCP region to deploy resources (e.g. `asia-south1`)                         |
| `terraform_gcs_name`  | Name of the GCS bucket to store the Terraform state file (e.g. `devops-terraform-state-01`) |
| `jenkins_bkp_gcs`     | Name of the GCS bucket to store Jenkins backup files (e.g. `devops-jenkins-bkp`) |
| `domain`              | Domain name used to access Jenkins and the deployed application (e.g. `nttd.dedyn.io`) |
| `jenkins_subdomain`   | Subdomain for accessing Jenkins (e.g. `jenkins`)                            |
| `app_subdoamin`       | Subdomain for accessing the React application on GCP App Engine (e.g. `app`) |
| `github_base_url`     | Base URL of the GitHub repository                                           |

> ‚ö†Ô∏è **Note:** Make sure to review and update each value to reflect your specific environment and project setup before proceeding with the deployment.

--------------------------------------------------------------------------------------------------------------------------------------------------------------

‚ö†Ô∏è **Note:** For more details, refer to the `README.md` file present in each folder within the repository.
